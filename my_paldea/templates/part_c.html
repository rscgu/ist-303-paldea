{% extends 'base.html' %}
{% block container %}
{% set print_mode = request.args.get('print') %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<div class="container mt-5">
    <div class="text-center mb-5">
        <h1 class="mb-4">Part C: Team Member Tasks Presentation</h1>
        <p class="lead">Interactive Demo of Assigned Tasks for the Personal Finance Tracker Project</p>
        <p class="text-muted">Code Repository: <a href="https://github.com/rscgu/ist-303-paldea" target="_blank" rel="noopener">https://github.com/rscgu/ist-303-paldea</a></p>
        <p class="text-muted">Run locally: <code>python run.py</code> then visit <a href="http://127.0.0.1:5000/demo">http://127.0.0.1:5000/demo</a> for demo or <a href="http://127.0.0.1:5000/part-c">http://127.0.0.1:5000/part-c</a> for this presentation</p>
    </div>

    <!-- Background and Purpose Section -->
    <div class="card mb-5">
        <div class="card-header">
            <h3>Project Background and Purpose</h3>
        </div>
        <div class="card-body">
            <h5>Background</h5>
            <p>The Personal Finance Tracker is an application designed to help users record daily financial transactions, categorize expenses, and visualize spending patterns. It provides a simple, user-friendly interface connected to an underlying database, enabling structured storage and retrieval of financial data. The project was developed as part of IST 303 coursework, focusing on building a comprehensive financial management tool.</p>

            <h5>Purpose</h5>
            <p>The primary purpose of this application is to bridge the gap between raw financial data and meaningful insights. By allowing users to track income, expenses, budgets, and goals, the app makes it easy for users to understand and control their finances. It serves various stakeholders including end users (students, professionals, families), developers, UI/UX designers, data analysts, and testers. The app aims to provide a unified system for financial management without requiring multiple services or signups.</p>

            <h5>Key Features</h5>
            <ul>
                <li>Transaction recording and categorization (income and expense)</li>
                <li>Budget setting and progress tracking with visual indicators</li>
                <li>Financial goal setting and achievement monitoring</li>
                <li>Data visualization through charts and summaries</li>
                <li>User authentication and secure data management</li>
                <li>Filtering and reporting capabilities</li>
            </ul>

            <h5>Team Members</h5>
            <p>The development team consists of Samantha Aguirre, Gerves Francois Baniakina, Qiao Huang, Rachan Sailamai, and Manish Shrivastav, each assigned to specific epics and tasks as outlined below.</p>
        </div>
    </div>

    <!-- Working Code Demonstration Section -->
    <div class="card mb-5">
        <div class="card-header">
            <h3>Working Code Demonstration</h3>
        </div>
        <div class="card-body">
            <h5>Live Application Demo</h5>
            <p>The application is currently running and can be accessed at:</p>
            <ul>
                <li><strong>Part C Presentation:</strong> <a href="http://127.0.0.1:5000/part-c" target="_blank">http://127.0.0.1:5000/part-c</a></li>
                <li><strong>App Demo with Sample Data:</strong> <a href="http://127.0.0.1:5000/demo" target="_blank">http://127.0.0.1:5000/demo</a></li>
                <li><strong>Full Application:</strong> <a href="http://127.0.0.1:5000" target="_blank">http://127.0.0.1:5000</a></li>
            </ul>
            <p><strong>To run locally:</strong> Execute <code>python run.py</code> in the project directory.</p>

            <h5>Milestone 1.0 Status</h5>
            <p>All core features have been implemented and are functional:</p>
            <ul>
                <li>✅ User registration and authentication</li>
                <li>✅ Transaction recording (add/edit/delete)</li>
                <li>✅ Category-based expense tracking</li>
                <li>✅ <strong>Integrated Budget Management:</strong> Category budgets with progress bars, alerts, and sample data</li>
                <li>✅ Financial goal setting</li>
                <li>✅ Data visualization (pie and bar charts)</li>
                <li>✅ Date-based filtering (week/month/year)</li>
                <li>✅ Responsive web interface</li>
            </ul>

            <h6>Budget Management Integration</h6>
            <p>The budget management system has been fully integrated into the main application:</p>
            <ul>
                <li><strong>Budget Setting:</strong> <a href="http://127.0.0.1:5000/budget" target="_blank">/budget</a> - Set category-specific monthly budgets</li>
                <li><strong>Progress Tracking:</strong> <a href="http://127.0.0.1:5000/budget_progress" target="_blank">/budget_progress</a> - Visual progress bars with color-coded alerts</li>
                <li><strong>Sample Data:</strong> <a href="http://127.0.0.1:5000/add_sample_data" target="_blank">/add_sample_data</a> - Populate demo transactions for testing</li>
                <li><strong>Dashboard Integration:</strong> Budget progress displayed on home page alongside charts</li>
            </ul>
        </div>
    </div>

    <!-- How Code Fulfills User Stories Section -->
    <div class="card mb-5">
        <div class="card-header">
            <h3>How Code Fulfills User Stories</h3>
        </div>
        <div class="card-body">
            <h5>Epic 1: Core Transaction Management (Gerves & Samantha)</h5>
            <p><strong>User Story:</strong> "As a user, I want to record my daily financial transactions so that I can track my income and expenses."</p>
            <p><strong>Fulfillment:</strong> Implemented authentication system, transaction CRUD operations, and category association. Users can securely log in, add income/expense transactions with descriptions, amounts, and categories.</p>

            <h5>Epic 2: Budgeting & Alerts (Qiao & Rachan)</h5>
            <p><strong>User Story:</strong> "As a user, I want to set monthly budgets for different expense categories so that I can control my spending."</p>
            <p><strong>Fulfillment:</strong> Category-based budget setting with visual progress bars. Users receive alerts when budgets are exceeded, and can track financial goals with progress indicators.</p>

            <h5>Epic 3: Visualization & Reporting (Manish)</h5>
            <p><strong>User Story:</strong> "As a user, I want to visualize my spending patterns through charts so that I can understand my financial habits."</p>
            <p><strong>Fulfillment:</strong> Interactive pie charts for category spending and bar charts for income vs expense comparison. Date filtering allows users to view data by week, month, or year.</p>
        </div>
    </div>

    <!-- What the Code Does Section -->
    <div class="card mb-5">
        <div class="card-header">
            <h3>What the Code Does</h3>
        </div>
        <div class="card-body">
            <h5>Core Functionality</h5>
            <p>The Personal Finance Tracker provides a comprehensive web-based solution for personal financial management:</p>

            <h6>1. User Management</h6>
            <p>Secure user registration and login system with password hashing and session management.</p>

            <h6>2. Transaction Tracking</h6>
            <p>Complete CRUD operations for financial transactions, supporting both income and expense categorization.</p>

            <h6>3. Budget Management</h6>
            <p>Category-specific budget setting with real-time progress tracking and visual indicators.</p>

            <h6>4. Goal Setting</h6>
            <p>Financial goal creation and monitoring with progress visualization and deadline tracking.</p>

            <h6>5. Data Visualization</h6>
            <p>Interactive charts powered by Chart.js for spending analysis and financial insights.</p>

            <h6>6. Reporting & Filtering</h6>
            <p>Flexible date-based filtering and comprehensive financial summaries.</p>
        </div>
    </div>

    <!-- Agile Methods Documentation Section -->
    <div class="card mb-5">
        <div class="card-header">
            <h3>Documentation of Agile Methods</h3>
        </div>
        <div class="card-body">
            <h5>Project Structure</h5>
            <p>The project was organized using agile methodologies with clear epic and task breakdowns:</p>

            <h6>Directory Structure:</h6>
            <pre><code>personal-finance-tracker/
│
├── my_paldea/
│   ├── __init__.py           # Application factory
│   ├── models.py             # Database models
│   ├── views.py              # View functions
│   ├── config.py             # Configuration
│   ├── finSystem.py          # Financial system logic
│   ├── templates/
│   │   ├── base.html         # Base template
│   │   ├── index.html        # Home page
│   │   ├── budget.html       # Budget setting form
│   │   ├── budget_progress.html # Progress visualization
│   │   ├── login.html        # Authentication
│   │   └── register.html     # User registration
│   └── static/
│       ├── css/main.css      # Custom styling
│       └── js/main.js        # JavaScript functionality
│
├── Part C/                   # Milestone 1.0 presentation materials
├── app.py                    # Main Flask application
├── budget_routes.py          # Budget-specific routes
├── run.py                    # Application runner
├── requirements.txt          # Python dependencies
├── finance.db               # SQLite database
└── README.md                # This file</code></pre>

            <h6>Epics Defined:</h6>
            <ul>
                <li><strong>Epic 1:</strong> Core Transaction Management (Authentication, CRUD operations)</li>
                <li><strong>Epic 2:</strong> Budgeting & Alerts (Budget setting, progress tracking, goal management)</li>
                <li><strong>Epic 3:</strong> Visualization & Reporting (Charts, filtering, summaries)</li>
            </ul>

            <h6>Task Assignment:</h6>
            <p>Each team member was assigned specific epics and tasks based on expertise and workload balance:</p>
            <ul>
                <li>Samantha Aguirre - Epic 1.2: Transaction Management Continued</li>
                <li>Gerves Francois Baniakina - Epic 1: Core Transaction Management</li>
                <li>Qiao Huang - Epic 2: Budgeting & Alerts (Part 1)</li>
                <li>Rachan Sailamai - Epic 2: Budgeting & Alerts (Part 2)</li>
                <li>Manish Shrivastav - Epic 3: Visualization & Reporting</li>
            </ul>

            <h6>Iterative Development:</h6>
            <p>The project followed iterative development principles with:</p>
            <ul>
                <li>Incremental feature implementation</li>
                <li>Regular code reviews and integration</li>
                <li>Working software delivered in milestones</li>
                <li>Continuous testing and bug fixing</li>
            </ul>

            <h6>User Story Mapping:</h6>
            <p>All features were developed based on defined user stories with clear acceptance criteria, ensuring that development remained focused on user needs and business value.</p>
        </div>
    </div>

    <!-- Code Testing Explanation Section -->
    <div class="card mb-5">
        <div class="card-header">
            <h3>Explanation of How the Code Was Tested</h3>
        </div>
        <div class="card-body">
            <h5>Testing Approach</h5>
            <p>The application underwent comprehensive testing to ensure functionality, usability, and reliability:</p>

            <h6>1. Unit Testing</h6>
            <p>Individual components were tested in isolation:</p>
            <ul>
                <li>Form validation for user registration and login</li>
                <li>Transaction CRUD operations</li>
                <li>Database model relationships</li>
                <li>Budget calculation logic</li>
            </ul>

            <h6>2. Integration Testing</h6>
            <p>Complete user workflows were tested end-to-end:</p>
            <ul>
                <li>User registration → login → transaction management</li>
                <li>Budget setting → transaction recording → progress display</li>
                <li>Goal creation → progress tracking → completion monitoring</li>
            </ul>

            <h6>3. UI/UX Testing</h6>
            <p>Interface functionality was verified through browser testing:</p>
            <ul>
                <li>Responsive design across different screen sizes</li>
                <li>Form interactions and validation feedback</li>
                <li>Chart rendering and data accuracy</li>
                <li>Navigation and user flow</li>
            </ul>

            <h6>4. Demo Testing</h6>
            <p>Sample data was used to demonstrate all features:</p>
            <ul>
                <li>Pre-populated transactions for chart visualization</li>
                <li>Test user accounts for authentication testing</li>
                <li>Various budget scenarios for alert system validation</li>
            </ul>

            <h6>5. Browser Compatibility</h6>
            <p>Testing was performed across multiple browsers to ensure consistent behavior and appearance.</p>
        </div>
    </div>

    <!-- Agile Methods for Milestone 2.0 Section -->
    <div class="card mb-5">
        <div class="card-header">
            <h3>Agile Methods for Milestone 2.0 Development</h3>
        </div>
        <div class="card-body">
            <h5>Project Structure and Epics</h5>
            <p>Milestone 2.0 focuses on three key epics to enhance the Personal Finance Tracker with advanced visualization, reporting capabilities, and international support:</p>

            <ul>
                <li><strong>Epic 4: Enhanced Visualization</strong> - Trend charts, forecasting, and interactive dashboards</li>
                <li><strong>Epic 5: Export & Reporting</strong> - PDF reports, CSV export, and tax preparation features</li>
                <li><strong>Epic 6: Multi-Currency Support</strong> - International transaction and currency conversion</li>
            </ul>

            <h5>Burndown Chart</h5>
            <p>The following burndown chart shows the progress of tasks completed over time for Milestone 2.0:</p>
            <div class="text-center mb-4">
                <img src="{{ url_for('static', filename='burndown_chart.jpg') }}" alt="Burndown Chart" class="img-fluid" style="max-width: 100%; height: auto;">
            </div>

            <h5>Team Member Assignments for Milestone 2.0</h5>
            <p>Building on Milestone 1.0 expertise, team members are assigned to lead specific epics:</p>

            <ul>
                <li><strong>Samantha Aguirre - Epic 4: Enhanced Visualization</strong>
                    <ul>
                        <li>Task 21: Implement trend line charts for spending patterns</li>
                        <li>Task 22: Add forecasting algorithms for expense prediction</li>
                        <li>Task 23: Create interactive drill-down chart capabilities</li>
                        <li>Task 24: Develop custom dashboard layouts</li>
                    </ul>
                </li>
                <li><strong>Gerves Francois Baniakina - Epic 5: Export & Reporting</strong>
                    <ul>
                        <li>Task 25: Generate PDF financial reports with charts</li>
                        <li>Task 26: Implement CSV data export functionality</li>
                        <li>Task 27: Create tax preparation summary reports</li>
                        <li>Task 28: Add scheduled report generation</li>
                    </ul>
                </li>
                <li><strong>Qiao Huang - Epic 6: Multi-Currency Support</strong>
                    <ul>
                        <li>Task 45: Integrate currency exchange rate APIs</li>
                        <li>Task 46: Implement multi-currency transaction handling</li>
                        <li>Task 47: Add currency preference settings</li>
                        <li>Task 48: Create currency conversion history tracking</li>
                    </ul>
                </li>
                <li><strong>Rachan Sailamai - Epic 4: Enhanced Visualization (Support)</strong>
                    <ul>
                        <li>Task 21: Assist with trend line chart implementation</li>
                        <li>Task 23: Support interactive drill-down features</li>
                        <li>Task 24: Help with custom dashboard layouts</li>
                    </ul>
                </li>
                <li><strong>Manish Shrivastav - Epic 5: Export & Reporting (Support)</strong>
                    <ul>
                        <li>Task 26: Assist with CSV export functionality</li>
                        <li>Task 27: Support tax preparation reports</li>
                        <li>Task 28: Help with scheduled report generation</li>
                    </ul>
                </li>
            </ul>

            <h5>Agile Development Practices</h5>
            <p>Milestone 2.0 follows agile practices with weekly meetings:</p>
            <ul>
                <li><strong>Weekly Meetings:</strong> Team syncs every week to review progress and plan next steps</li>
                <li><strong>User Story Refinement:</strong> Detailed acceptance criteria and definition of done</li>
                <li><strong>Continuous Integration:</strong> Automated testing and deployment pipelines</li>
                <li><strong>Code Quality:</strong> Code reviews, static analysis, and automated testing</li>
                <li><strong>Documentation:</strong> API docs, user guides, and technical specifications</li>
                <li><strong>Stakeholder Collaboration:</strong> Regular demos and feedback sessions</li>
            </ul>

            <h5>Success Metrics and KPIs</h5>
            <ul>
                <li>Code coverage: 90%+ automated test coverage</li>
                <li>Performance: <2 second page load times, <500ms API response times</li>
                <li>User adoption: Mobile app downloads, feature usage analytics</li>
                <li>Quality: <5 critical bugs per release, >95% uptime</li>
                <li>Delivery: On-time sprint completion, predictable release cycles</li>
            </ul>
        </div>
    </div>

    <div class="accordion" id="teamAccordion">
        {% for member, details in team_members.items() %}
        <div class="accordion-item">
            <h2 class="accordion-header" id="heading{{ loop.index }}">
                <button class="accordion-button{% if not print_mode %} collapsed{% endif %}" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ loop.index }}" aria-expanded="{{ 'true' if print_mode else 'false' }}" aria-controls="collapse{{ loop.index }}">
                    <strong>{{ member }}</strong> - {{ details.epic }}
                </button>
            </h2>
            <div id="collapse{{ loop.index }}" class="accordion-collapse collapse{% if print_mode %} show{% endif %}" aria-labelledby="heading{{ loop.index }}" data-bs-parent="#teamAccordion">
                <div class="accordion-body">
                    <h5>Linked User Stories: {{ details.user_stories }}</h5>
                    <p><em>{{ details.summary }}</em></p>
                    <h6>Assigned Tasks:</h6>
                    <ul class="list-group list-group-flush">
                        {% for task in details.tasks %}
                        <li class="list-group-item">{{ task }}</li>
                        {% endfor %}
                    </ul>
                    <h6>Relevant Code Files:</h6>
                    <ul class="list-group list-group-flush">
                        {% if member == 'Samantha Aguirre' %}
                        <li class="list-group-item"><code>my_paldea/paldea_app/views.py</code> - Transaction categorization logic</li>
                        <li class="list-group-item"><code>my_paldea/templates/home.html</code> - Transaction list display</li>
                        <li class="list-group-item"><code>my_paldea/paldea_app/models.py</code> - Transaction model with edit/delete methods</li>
                        {% elif member == 'Gerves Francois Baniakina' %}
                        <li class="list-group-item"><code>my_paldea/paldea_app/views.py</code> - Authentication routes (login, register)</li>
                        <li class="list-group-item"><code>my_paldea/paldea_app/models.py</code> - User, Transaction, Category models</li>
                        <li class="list-group-item"><code>scripts/init_db.py</code> - Database schema initialization</li>
                        {% elif member == 'Qiao Huang' %}
                        <li class="list-group-item"><code>my_paldea/paldea_app/views.py</code> - Budget setting and progress calculation</li>
                        <li class="list-group-item"><code>my_paldea/paldea_app/models.py</code> - CategoryBudget model</li>
                        <li class="list-group-item"><code>my_paldea/templates/home.html</code> - Progress bar UI components</li>
                        {% elif member == 'Rachan Sailamai' %}
                        <li class="list-group-item"><code>my_paldea/paldea_app/views.py</code> - Budget alert logic</li>
                        <li class="list-group-item"><code>my_paldea/paldea_app/models.py</code> - Goal model with progress tracking</li>
                        <li class="list-group-item"><code>my_paldea/templates/home.html</code> - Goal setting forms and progress markers</li>
                        {% elif member == 'Manish Shrivastav' %}
                        <li class="list-group-item"><code>my_paldea/templates/home.html</code> - Chart.js integration for pie and bar charts</li>
                        <li class="list-group-item"><code>my_paldea/paldea_app/views.py</code> - Chart data preparation and filtering logic</li>
                        <li class="list-group-item"><code>my_paldea/static/js/main.js</code> - Chart rendering and date filtering</li>
                        {% endif %}
                    </ul>
                    <!-- Code Snippets and Explanations -->
                    <div class="accordion mt-3" id="codeAccordion{{ loop.index }}">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="codeHeading{{ loop.index }}">
                                <button class="accordion-button{% if not print_mode %} collapsed{% endif %}" type="button" data-bs-toggle="collapse" data-bs-target="#codeCollapse{{ loop.index }}" aria-expanded="{{ 'true' if print_mode else 'false' }}" aria-controls="codeCollapse{{ loop.index }}">
                                    Code Snippets and Explanations
                                </button>
                            </h2>
                            <div id="codeCollapse{{ loop.index }}" class="accordion-collapse collapse{% if print_mode %} show{% endif %}" aria-labelledby="codeHeading{{ loop.index }}" data-bs-parent="#codeAccordion{{ loop.index }}">
                                <div class="accordion-body">
                                    {% if member == 'Samantha Aguirre' %}
                                    <h6>File: my_paldea/paldea_app/views.py (Add Transaction Route)</h6>
                                    <p>This route handles adding new transactions, categorizing them as income or expense, and associating them with categories.</p>
                                    <pre><code class="language-python">@paldea_app.route('/add_transaction', methods=['POST'])
@login_required
def add_transaction():
    form = TransactionForm()
    categories = Category.query.all()
    form.category.choices = [(c.id, c.name) for c in categories]
    if form.validate_on_submit():
        transaction = Transaction(description=form.description.data, amount=form.amount.data, type=form.type.data, category_id=form.category.data, user_id=current_user.id)
        db.session.add(transaction)
        db.session.commit()
        flash('Transaction added successfully!', 'success')
    return redirect(url_for('paldea_app.home'))</code></pre>

                                    <h6>File: my_paldea/paldea_app/views.py (Edit Transaction Route)</h6>
                                    <p>This route allows users to edit existing transactions, updating description, amount, type, and category.</p>
                                    <pre><code class="language-python">@paldea_app.route('/edit_transaction/<int:transaction_id>', methods=['GET', 'POST'])
@login_required
def edit_transaction(transaction_id):
    transaction = Transaction.query.get_or_404(transaction_id)
    if transaction.user_id != current_user.id:
        flash('You do not have permission to edit this transaction.', 'danger')
        return redirect(url_for('paldea_app.home'))

    form = TransactionForm()
    categories = Category.query.all()
    form.category.choices = [(c.id, c.name) for c in categories]
    if request.method == 'GET':
        form.description.data = transaction.description
        form.amount.data = transaction.amount
        form.type.data = transaction.type
        form.category.data = transaction.category_id

    if form.validate_on_submit():
        transaction.description = form.description.data
        transaction.amount = form.amount.data
        transaction.type = form.type.data
        transaction.category_id = form.category.data
        db.session.commit()
        flash('Transaction updated successfully!', 'success')
        return redirect(url_for('paldea_app.home'))

    return render_template('edit_transaction.html', form=form, transaction=transaction)</code></pre>

                                    <h6>File: my_paldea/paldea_app/views.py (Delete Transaction Route)</h6>
                                    <p>This route handles deletion of transactions with user permission checks.</p>
                                    <pre><code class="language-python">@paldea_app.route('/delete_transaction/<int:transaction_id>', methods=['POST'])
@login_required
def delete_transaction(transaction_id):
    transaction = Transaction.query.get_or_404(transaction_id)
    if transaction.user_id != current_user.id:
        flash('You do not have permission to delete this transaction.', 'danger')
        return redirect(url_for('paldea_app.home'))

    db.session.delete(transaction)
    db.session.commit()
    flash('Transaction deleted successfully!', 'success')
    return redirect(url_for('paldea_app.home'))</code></pre>

                                    <h6>File: my_paldea/templates/home.html (Transaction List Display)</h6>
                                    <p>This template section renders the transaction history table with edit/delete actions.</p>
                                    <pre><code class="language-html">{% raw %}{% for transaction in transactions %}
                                            <tr>
                                                <td>{{ transaction.date.strftime('%Y-%m-%d %H:%M') }}</td>
                                                <td>{{ transaction.description }}</td>
                                                <td>
                                                    {% if transaction.type == 'income' %}
                                                        <span class="badge bg-success">Income</span>
                                                    {% else %}
                                                        <span class="badge bg-danger">Expense</span>
                                                    {% endif %}
                                                </td>
                                                <td>{{ transaction.category.name if transaction.category else 'N/A' }}</td>
                                                <td>${{ "%.2f"|format(transaction.amount) }}</td>
                                                <td>
                                                    {% if not demo %}
                                                    <a href="{{ url_for('paldea_app.edit_transaction', transaction_id=transaction.id) }}" class="btn btn-sm btn-warning">Edit</a>
                                                    <form method="POST" action="{{ url_for('paldea_app.delete_transaction', transaction_id=transaction.id) }}" style="display:inline;">
                                                        <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this transaction?')">Delete</button>
                                                    </form>
                                                    {% else %}
                                                    <span class="text-muted">Demo Mode - Actions Disabled</span>
                                                    {% endif %}
                                                </td>
                                            </tr>
                                        {% endfor %}{% endraw %}</code></pre>
                                    {% elif member == 'Gerves Francois Baniakina' %}
                                    <h6>File: my_paldea/paldea_app/views.py (Registration Route)</h6>
                                    <p>This route handles user registration, validating input and creating new user accounts.</p>
                                    <pre><code class="language-python">@paldea_app.route('/register', methods=['GET', 'POST'])
def register():
    if session.get('username') or current_user.is_authenticated:
        flash('You are already logged in.', 'info')
        return redirect(url_for('paldea_app.home'))

    form = RegistrationForm()
    if form.validate_on_submit():
        username = form.username.data
        email = form.email.data
        password = form.password.data

        # Check if username or email already exists
        existing_user = User.query.filter(
            (User.username == username) | (User.email == email)
        ).first()
        if existing_user:
            if existing_user.username == username:
                    flash('This username is already taken. Please choose another.', 'warning')
            if existing_user.email == email:
                flash('This email is already registered. Please use another.', 'warning')
            return render_template('register.html', form=form)

        # Create new user
        user = User(username=username, password=password, email=email)
        db.session.add(user)
        db.session.commit()

        flash('You are now registered. Please login.', 'success')
        return redirect(url_for('paldea_app.login'))

    if form.errors:
        for field, errors in form.errors.items():
            for error in errors:
                flash(f"{field.capitalize()}: {error}", 'danger')

    return render_template('register.html', form=form)</code></pre>

                                    <h6>File: my_paldea/paldea_app/views.py (Login Route)</h6>
                                    <p>This route handles user authentication, supporting both local database and OAuth login.</p>
                                    <pre><code class="language-python">@paldea_app.route("/login", methods=["GET", "POST"])
def login():
    form = LoginForm()

    if form.validate_on_submit():  # triggered on POST if validators pass
        username = form.username.data
        password = form.password.data

        # --- Try local DB login first ---
        user = User.query.filter_by(username=username).first()
        if user and user.check_password(password):
            login_user(user)
            session["user_id"] = user.id
            flash("Logged in successfully!", "success")
            return redirect(url_for("paldea_app.home"))
        else:
            flash("Invalid username or password", "danger")
            return render_template("login.html", form=form)

    # GET request or failed POST → show form
    return render_template("login.html", form=form)</code></pre>

                                    <h6>File: my_paldea/paldea_app/models.py (User Model)</h6>
                                    <p>The User model handles authentication, password hashing, and budget tracking.</p>
                                    <pre><code class="language-python">class User(UserMixin,db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(150),nullable=False, unique=True)
    email = db.Column(db.String(150), nullable=False, unique=True)
    pwdhash = db.Column(db.String(256), nullable=False)
    budget = db.Column(db.Float, default=0.0)  # Monthly budget
    expenses = db.relationship('Expense', backref='user', lazy=True)

    def __init__(self, username, password, email):
        self.username = username
        if password:
            self.pwdhash = generate_password_hash(password, method='pbkdf2:sha256')
        else:
            self.pwdhash = ''
        self.email = email

    def get_total_expenses(self):
        return sum(expense.amount for expense in self.expenses)

    def is_budget_exceeded(self):
        return self.get_total_expenses() > self.budget if self.budget > 0 else False

    def check_password(self, password):
        return check_password_hash(self.pwdhash,password)</code></pre>

                                    <h6>File: scripts/init_db.py (Database Initialization)</h6>
                                    <p>This script creates database tables and populates default categories.</p>
                                    <pre><code class="language-python">from my_paldea import db, create_app
from my_paldea.paldea_app.models import Category

app = create_app()

with app.app_context():
    db.create_all()

    # Add default categories if they don't exist
    default_categories = ['Groceries', 'Entertainment', 'Rent', 'Utilities', 'Transportation', 'Dining', 'Healthcare', 'Shopping', 'Salary', 'Freelance', 'Investments']
    for cat_name in default_categories:
        if not Category.query.filter_by(name=cat_name).first():
            category = Category(name=cat_name)
            db.session.add(category)
    db.session.commit()

print("Database initialized with tables and default categories.")</code></pre>
                                    {% elif member == 'Qiao Huang' %}
                                    <h6>File: my_paldea/paldea_app/views.py (Set Category Budget Route)</h6>
                                    <p>This route allows users to set spending limits for different expense categories.</p>
                                    <pre><code class="language-python">@paldea_app.route('/set_category_budget', methods=['POST'])
@login_required
def set_category_budget():
    form = CategoryBudgetForm()
    categories = Category.query.all()
    form.category.choices = [(c.id, c.name) for c in categories]
    if form.validate_on_submit():
        # Check if budget already exists for this category and user
        existing_budget = CategoryBudget.query.filter_by(user_id=current_user.id, category_id=form.category.data).first()
        if existing_budget:
            existing_budget.budget_amount = form.budget_amount.data
        else:
            budget = CategoryBudget(user_id=current_user.id, category_id=form.category.data, budget_amount=form.budget_amount.data)
            db.session.add(budget)
        db.session.commit()
        flash('Category budget set successfully!', 'success')
    return redirect(url_for('paldea_app.home'))</code></pre>

                                    <h6>File: my_paldea/paldea_app/models.py (CategoryBudget Model)</h6>
                                    <p>The CategoryBudget model stores user-defined spending limits for categories.</p>
                                    <pre><code class="language-python">class CategoryBudget(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=False)
    category_id = db.Column(db.Integer, db.ForeignKey('category.id'), nullable=False)
    budget_amount = db.Column(db.Float, nullable=False)
    time_period = db.Column(db.String(20), default='monthly')  # 'monthly', 'yearly', etc.

    user = db.relationship('User', backref='category_budgets')
    category = db.relationship('Category', backref='budgets')

    def __repr__(self):
        return f'<CategoryBudget {self.category.name}: ${self.budget_amount} ({self.time_period})>'</code></pre>

                                    <h6>File: my_paldea/templates/home.html (Progress Bar UI)</h6>
                                    <p>This template section displays visual progress bars showing budget usage with color coding.</p>
                                    <pre><code class="language-html">{% raw %}{% for budget in category_budgets %}
                            {% set spent = category_spent.get(budget.category_id, 0) %}
                            {% set percentage = (spent / budget.budget_amount * 100) if budget.budget_amount > 0 else 0 %}
                            {% set progress_class = 'bg-success' if percentage < 70 else 'bg-warning' if percentage < 90 else 'bg-danger' %}
                            <div class="mb-3">
                                <h5>{{ budget.category.name }}</h5>
                                <div class="progress mb-2">
                                    <div class="progress-bar {{ progress_class }}" role="progressbar" style="width: {{ percentage }}%" aria-valuenow="{{ percentage }}" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <p class="mb-0">${{ "%.2f"|format(spent) }} of ${{ "%.2f"|format(budget.budget_amount) }} spent ({{ "%.1f"|format(percentage) }}%)</p>
                                {% if percentage > 100 %}
                                    <div class="alert alert-danger mt-2">
                                        <strong>Alert!</strong> You have exceeded your budget for {{ budget.category.name }}!
                                    </div>
                                {% endif %}
                            </div>
                        {% endfor %}{% endraw %}</code></pre>
                                    {% elif member == 'Rachan Sailamai' %}
                                    <h6>File: my_paldea/paldea_app/views.py (Set Goal Route)</h6>
                                    <p>This route handles setting financial goals for savings, investments, or loans.</p>
                                    <pre><code class="language-python">@paldea_app.route('/set_goal', methods=['POST'])
@login_required
def set_goal():
    form = GoalForm()
    if form.validate_on_submit():
        goal = Goal(user_id=current_user.id, goal_type=form.goal_type.data, target_amount=form.target_amount.data, deadline=form.deadline.data, description=form.description.data)
        db.session.add(goal)
        db.session.commit()
        flash('Goal set successfully!', 'success')
    return redirect(url_for('paldea_app.home'))</code></pre>

                                    <h6>File: my_paldea/paldea_app/models.py (Goal Model)</h6>
                                    <p>The Goal model tracks financial objectives with progress monitoring.</p>
                                    <pre><code class="language-python">class Goal(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=False)
    goal_type = db.Column(db.String(50), nullable=False)  # 'savings', 'investments', 'loans'
    target_amount = db.Column(db.Float, nullable=False)
    current_amount = db.Column(db.Float, default=0.0)
    deadline = db.Column(db.Date, nullable=False)
    description = db.Column(db.String(200))

    def __repr__(self):
        return f'<Goal {self.goal_type}: ${self.target_amount}>'</code></pre>

                                    <h6>File: my_paldea/templates/home.html (Goal Progress Display)</h6>
                                    <p>This template section shows goal progress with visual indicators and deadlines.</p>
                                    <pre><code class="language-html">{% raw %}{% for goal in goals %}
                            {% set progress = ((goal.current_amount or 0) / goal.target_amount * 100) if goal.target_amount and goal.target_amount > 0 else 0 %}
                            <div class="mb-3">
                                <h5>{{ goal.goal_type.title() }} Goal</h5>
                                <p>{{ goal.description or 'No description' }}</p>
                                <div class="progress mb-2">
                                    <div class="progress-bar bg-info" role="progressbar" style="width: {{ progress }}%" aria-valuenow="{{ progress }}" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <p class="mb-0">${{ "%.2f"|format(goal.current_amount or 0) }} of ${{ "%.2f"|format(goal.target_amount) }} ({{ "%.1f"|format(progress) }}%)</p>
                                <p class="text-muted">Deadline: {{ goal.deadline.strftime('%Y-%m-%d') }}</p>
                            </div>
                        {% endfor %}{% endraw %}</code></pre>

                                    <h6>File: my_paldea/templates/home.html (Budget Alert Logic)</h6>
                                    <p>This template logic checks for budget overspending and displays alerts.</p>
                                    <pre><code class="language-html">{% raw %}{% if percentage > 100 %}
                                    <div class="alert alert-danger mt-2">
                                        <strong>Alert!</strong> You have exceeded your budget for {{ budget.category.name }}!
                                    </div>
                                {% endif %}{% endraw %}</code></pre>
                                    {% elif member == 'Manish Shrivastav' %}
                                    <h6>File: my_paldea/templates/home.html (Chart.js Integration)</h6>
                                    <p>This template section integrates Chart.js for pie and bar chart visualizations.</p>
                                    <pre><code class="language-html">{% raw %}<script>
    // Pie Chart
    const pieCtx = document.getElementById('pieChart').getContext('2d');
    const pieChart = new Chart(pieCtx, {
        type: 'pie',
        data: {
            labels: {{ pie_labels|tojson }},
            datasets: [{
                data: {{ pie_data|tojson }},
                backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF']
            }]
        }
    });

    // Bar Chart
    const barCtx = document.getElementById('barChart').getContext('2d');
    const barChart = new Chart(barCtx, {
        type: 'bar',
        data: {
            labels: {{ bar_labels|tojson }},
            datasets: [{
                data: {{ bar_data|tojson }},
                backgroundColor: ['#36A2EB', '#FF6384']
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
</script>{% endraw %}</code></pre>

                                    <h6>File: my_paldea/paldea_app/views.py (Chart Data Preparation)</h6>
                                    <p>This view logic prepares data for charts, calculating spending by category and monthly income/expense.</p>
                                    <pre><code class="language-python"># Data for charts
pie_labels = [cb.category.name for cb in category_budgets if cb.category]
pie_data = [category_spent.get(cb.category_id, 0) for cb in category_budgets if cb.category]

# Monthly income vs expense bar chart (current month)
monthly_transactions = [t for t in transactions if t.date.month == now.month and t.date.year == now.year]
income = sum(t.amount for t in monthly_transactions if t.type == 'income')
expense = sum(t.amount for t in monthly_transactions if t.type == 'expense')
bar_labels = ['Income', 'Expense']
bar_data = [income, expense]</code></pre>

                                    <h6>File: my_paldea/paldea_app/views.py (Filtering Logic)</h6>
                                    <p>This view implements date-based filtering for transactions (week, month, year).</p>
                                    <pre><code class="language-python"># Filter transactions based on query params
filter_type = request.args.get('filter_type')
filter_period = request.args.get('filter_period')
now = datetime.utcnow()
if filter_type:
    transactions = [t for t in transactions if t.type == filter_type]
if filter_period:
    if filter_period == 'week':
        start_date = now - timedelta(days=7)
    elif filter_period == 'month':
        start_date = datetime(now.year, now.month, 1)
    elif filter_period == 'year':
        start_date = datetime(now.year, 1, 1)
    transactions = [t for t in transactions if t.date >= start_date]</code></pre>

                                    <h6>File: my_paldea/templates/home.html (Filter UI)</h6>
                                    <p>This template provides the user interface for filtering transactions by type and period.</p>
                                    <pre><code class="language-html">{% raw %}<form method="GET" class="d-flex mb-3">
    <select name="filter_type" class="form-select me-2">
        <option value="">All Types</option>
        <option value="income">Income</option>
        <option value="expense">Expense</option>
    </select>
    <select name="filter_period" class="form-select me-2">
        <option value="">All Time</option>
        <option value="week">This Week</option>
        <option value="month">This Month</option>
        <option value="year">This Year</option>
    </select>
    <button type="submit" class="btn btn-primary">Filter</button>
</form>{% endraw %}</code></pre>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
